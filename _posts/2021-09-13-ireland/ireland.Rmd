---
title: "üáÆüá™ Coronavirus in Ireland ü¶†"
description: |
  A short Coronavirus analysis and visualisation for the home of Guinness Beer üç∫
author:
  - name: Xueqi Goh
    url: https://www.instagram.com/xuxuehgo/?hl=en
    affiliation: Linkedin
    affiliation_url: linkedin.com/in/xueqi-goh-b244811b1
date: 09-13-2021
output:
  distill::distill_article:
    self_contained: false
theme: null
css: "style.css"    
---

```{css, echo=FALSE}
.distill-site-header {
  background-color: rosybrown;
  font-color: white;
  font-family: cursive;
  font-size: 13pt;
}
```

```{css, echo=FALSE}
h1 {
 color: lightcoral;
}
```

```{css, echo=FALSE}
body{
  background-color: papayawhip
}
```

```{r message=FALSE, echo=FALSE}
library(readr)
library(dplyr)
library(tidyverse)
library(lubridate)
library(sparkline)
library(timeDate)
library(tidyr)
library(geojsonsf)
library(leaflet)
library(geojsonio)
library(plotly)
library(leaflet.extras)
library(tidyr)
library(dygraphs)
library(xts)  
library(TSstudio)
```

üáÆüá™üáÆüá™üáÆüá™ The Republic of Ireland, known as the home of Guinness Beer, is a country with rich history, magical landscape, crowded Irish pubs and well-preserved castles. Like other countries, Ireland is still fighting with the coronavirus.


# Data Description üìñ

#### Data Source

#### Acknowledgment

```{r message=FALSE, echo=FALSE}
county <- read_csv("/Users/fairystephanie/Desktop/ETC5523/Blog1/blog-xgoh0002/data/Covid19CountyStatisticsHPSCIrelandOpenData.csv")
timestamp <- read_csv("/Users/fairystephanie/Desktop/ETC5523/Blog1/blog-xgoh0002/data/Covid19CountyStatisticsHPSCIreland.csv")
total <- read_csv("/Users/fairystephanie/Desktop/ETC5523/Blog1/blog-xgoh0002/data/CovidStatisticsProfileHPSCIrelandOpenData.csv")
```


# Findings üîç

Table 1 shows the total confirmed COVID-19 cases in each county in The Republic of Ireland. Data for the 26 counties are recorded. In addition, this table also provides the data of the population proportion covid cases and the population recorded in the Census 2016. It is very clear that Dublin has occupy the first place in the total number of confirmed covid cases, the population proportion covid cases and has the greatest population recorded in the Census 2016.

```{r, echo=FALSE}
table1 <- county %>%
  select(CountyName, PopulationProportionCovidCases, PopulationCensus16) %>%
  arrange(-PopulationCensus16)
  
```

```{r table1, echo=FALSE}
DT::datatable(table1, class = 'cell-border stripe', colnames = c('County Name',  'Population Proportion Covid Cases', 'Population Census 16'), caption = 'Table 1 -- The population each county in Ireland', filter = 'top', options = list( pageLength = 10)) 
```

The map below allows us to identify the spread of Coronavirus throughout the whole nation by showing the total confirmed covid cases in Ireland. We can see that Dublin and Cork has the greatest number 

```{r}
a <- geojson_sf("/Users/fairystephanie/Desktop/ETC5523/Blog1/blog-xgoh0002/data/cc.geojson")
```


```{r, echo=FALSE}
aa <- a %>% select(CountyName, ConfirmedCovidCases, geometry, ORIGID) %>%
  group_by(CountyName, ORIGID ) %>% 
  
summarise(ConfirmedCovidCases = sum(ConfirmedCovidCases))
```

```{r, echo=FALSE}

bins <- c(0, 2000, 4000, 6000, 10000, 15000, 20000, 30000, 100000, 150000)
pal <- colorBin("YlOrRd", domain = aa$ConfirmedCovidCases, bins = bins, na.color = "#aaaaaa")
labels <- sprintf(
  "<strong>%s</strong><br/>%g Confirmed COVID Cases <sup></sup>",
  aa$CountyName, aa$ConfirmedCovidCases
) %>% 
  lapply(htmltools::HTML)


m <- leaflet(aa) %>% addTiles()  %>% setView(-8,53.6,6) %>%
  addPolygons(color = "#444444", weight = 1, smoothFactor = 0.5,
    opacity = 1.0, fillOpacity = 0.5,
    fillColor = ~pal(ConfirmedCovidCases),
    highlightOptions = highlightOptions(color = "white", weight = 2,
      bringToFront = TRUE), label = labels,
              labelOptions = labelOptions(style = list("font-weight" = "normal", 
                                                       padding = "3px 8px"),
                                          textsize = "15px",
                                          direction = "auto")) %>% 
  leaflet::addLegend(pal=pal,values=~ConfirmedCovidCases,title = "Ireland Confirmed Covid Cases",position='bottomright')

m
```



```{r, echo=FALSE}
table3 <- timestamp %>%
  select(CountyName, TimeStamp, ConfirmedCovidCases) %>%
  mutate(Date = as.Date(TimeStamp)) 
table3[is.na(table3)] = 0
```

```{r, echo=FALSE}
finaltable3 <- table3 %>%
  select(Date, CountyName, ConfirmedCovidCases) %>%
  group_by(CountyName) 

```



```{r figure10, fig.cap= "The distribution of COVID cases across each county in Ireland From March 2020 to Sep 2021", echo=FALSE}
library(crosstalk)
tx <- highlight_key(finaltable3)
text <- list(family = "sans serif",
  size = 14,
  color = toRGB("grey50"))

widgets <- bscols(
  widths = c(12, 12),
  filter_select("CountyName", "County Name", tx, ~CountyName)
  #filter_slider("Date", "Select Date", tx, ~Date)
  #filter_select("province_territory", "Province Territory", tx, ~province_territory)
)
bscols(
  widths = c(2, 10), widgets, 
  plot_ly(tx, x = ~Date, y = ~ConfirmedCovidCases, showlegend = TRUE) %>% 
    add_bars(color = ~CountyName, text = ~paste('</br> CountyName: ', CountyName,
                      '</br> Date: ', Date,
                      '</br> ConfirmedCovidCases: ', ConfirmedCovidCases)))
```



```{r, echo=FALSE}
table4 <- total %>%
  select(Date, ConfirmedCovidCases, ConfirmedCovidDeaths) 
  
```

```{r, echo=FALSE}
xx <- table4 %>% xts(order.by = as.POSIXct(table4$Date))
```


```{r, echo=FALSE}
graph <- dygraph(xx, main = 'Figure 3 - New confirmed covid cases and new confirmed covid deaths') %>%
  dyOptions(labelsUTC = TRUE, fillGraph=TRUE, fillAlpha=0.1, drawGrid = FALSE, colors=RColorBrewer::brewer.pal(3, "Set2")) %>%
  dyLegend(show = "always", hideOnMouseOut = FALSE) %>%
  dyRangeSelector() %>%
  dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightCircleSize = 5, highlightSeriesBackgroundAlpha = 0.2, hideOnMouseOut = FALSE)  %>%
  dyRoller(rollPeriod = 1) 
graph
```

According to Figure 3 above, the orange time series line shwos the confirmed covid cases and the blue line shows the confirmed covid deaths in Ireland from March 2020 to September 2021. First and foremost, the most surprising point, the confirmed covid cases skyrocketed from the end of December and reaches it's peak on 7 of January 2021. Ireland achieved a total of 8348 confirmed covid cases and 20 confirmed covid deaths on 7 January 2021. In my opinion, people in Ireland could got infected due to the celebration of Christmas and New Year. There could be crowds celebrating festivals in public and disobeying the covid rules which will help in preventing infection. Thus, as it takes around 2 weeks to show symptoms of the Coronavirus, people remain unaware and did not quarantine and therefore infect others. This could be the reason causing the serious outbreak in January 2021. At the end of January 2021, the total confirmed covid cases in Ireland started to decrease and did not exceed 1000 cases each day. Perhaps the government has imposed a lockdown or other rules to stop this outbreak.
Next, starting from the mid of July, the trend of confirmed covid cases in Ireland started to rise again and has reaches it's peak in the mid of August and started to decrease.  

```{r, echo=FALSE}
table5 <- total %>%
  select( Male, Female, Unknown)
table5[is.na(table5)] = 0
  
```


```{r, echo=FALSE}
cc <- table5 %>%
  mutate(Male = Male - lag(Male, default = Male[1]),
         Female = Female - lag(Female, default = Female[1]),
         Unknown = Unknown - lag(Unknown, default = Unknown[1])) %>%
  summarise(Male = sum(Male),
            Female = sum(Female),
            Unknown = sum(Unknown))
```

```{r, echo=FALSE}
tt <- pivot_longer(cc, cols = Male:Unknown, names_to = c("Gender")) 
```



```{r, echo=FALSE}

fig <- plot_ly(tt, labels = ~Gender, values = ~value, type = 'pie')
fig <- fig %>% layout(title = 'Gender proportion of Covid cases in Ireland',
         xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
         yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))

fig
```


```{r, echo=FALSE}
last <- total %>%
  select(Aged1to4, Aged5to14, Aged15to24, Aged25to34, Aged35to44, Aged45to54, Aged55to64, Aged65to74, Aged75to84, Aged85up)
last[is.na(last)] = 0
```

```{r, echo=FALSE}
final <- last %>%
mutate(Aged1to4 = Aged1to4 - lag(Aged1to4, default = Aged1to4[1]),
       Aged5to14 = Aged5to14 - lag(Aged5to14, default = Aged5to14[1]),
       Aged15to24 = Aged15to24 - lag(Aged15to24, default = Aged15to24[1]),
       Aged25to34 = Aged25to34 - lag(Aged25to34, default = Aged25to34[1]),
       Aged35to44 = Aged35to44 - lag(Aged35to44, default = Aged35to44[1]),
       Aged45to54 = Aged45to54 - lag(Aged45to54, default = Aged45to54[1]),
       Aged55to64 = Aged55to64 - lag(Aged55to64, default = Aged55to64[1]),
       Aged65to74 = Aged65to74 - lag(Aged65to74, default = Aged65to74[1]),
       Aged85up = Aged85up - lag(Aged85up, default = Aged85up[1])) %>%
  summarise(Aged1to4 = sum(Aged1to4),
            Aged5to14 = sum(Aged5to14),
            Aged15to24 = sum(Aged15to24),
            Aged25to34 = sum(Aged25to34),
            Aged35to44 = sum(Aged35to44),
            Aged45to54 = sum(Aged45to54),
            Aged55to64 = sum(Aged55to64),
            Aged65to74 = sum(Aged65to74),
            Aged85up = sum(Aged85up)) 
  
#final1 <- final %>% pivot_longer(final, cols = Aged1to4:Aged85up, names_to = c("Age_Groups")) 
final1 <- gather(final, Age_group, value, Aged1to4:Aged85up, factor_key = TRUE)
```



```{r,fig.cap= "The distribution of Covid cases across each age groups", echo=FALSE}
plot_ly(final1, x =~Age_group, y =  ~value, showlegend = TRUE) %>% 
    add_bars(color = ~"Age_group", text = ~paste('</br> Age_group: ', Age_group,
                      '</br> sum: ', value))
```




```{r, echo=FALSE}
tablefinal <- total %>%
  select(Date, HospitalisedCovidCases, HealthcareWorkersCovidCases, RequiringICUCovidCases) 
tablefinal[is.na(tablefinal)] = 0
  
```

```{r, echo=FALSE}
tablefinal <- tablefinal %>%
  mutate(HospitalisedCovidCases = HospitalisedCovidCases - lag(HospitalisedCovidCases, default = HospitalisedCovidCases[1]),
         HealthcareWorkersCovidCases = HealthcareWorkersCovidCases - lag(HealthcareWorkersCovidCases, default = HealthcareWorkersCovidCases[1]),
         RequiringICUCovidCases = RequiringICUCovidCases - lag(RequiringICUCovidCases, default = RequiringICUCovidCases[1]))
```


```{r, echo=FALSE}
xxx <- tablefinal %>% xts(order.by = as.POSIXct(tablefinal$Date))
```


```{r, echo=FALSE}
graph2 <- dygraph(xxx, main = 'Hospitalised, Healthcare Workers and requiring ICU Covid cases') %>%
  dyOptions(labelsUTC = TRUE, fillGraph=TRUE, fillAlpha=0.1, drawGrid = FALSE, colors=RColorBrewer::brewer.pal(3, "Set2")) %>%
  dyLegend(show = "always", hideOnMouseOut = FALSE) %>%
  dyRangeSelector() %>%
  dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightCircleSize = 5, highlightSeriesBackgroundAlpha = 0.2, hideOnMouseOut = FALSE)  %>%
  dyRoller(rollPeriod = 1) 
graph2
```



