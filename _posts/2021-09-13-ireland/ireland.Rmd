---
title: "ðŸ‡®ðŸ‡ª Ireland ðŸ¦ "
description: |
  A short description of the post.
author:
  - name: Xueqi Goh
    url: https://www.instagram.com/xuxuehgo/?hl=en
    affiliation: Linkedin
    affiliation_url: linkedin.com/in/xueqi-goh-b244811b1
date: 09-13-2021
output:
  distill::distill_article:
    self_contained: false
theme: null
css: "style.css"    
---

```{css, echo=FALSE}
.distill-site-header {
  background-color: rosybrown;
  font-color: white;
  font-family: cursive;
  font-size: 13pt;
}
```

```{css, echo=FALSE}
h1 {
 color: lightcoral;
}
```

```{css, echo=FALSE}
body{
  background-color: papayawhip
}
```

```{r message=FALSE}
library(readr)
library(dplyr)
library(tidyverse)
library(lubridate)
library(sparkline)
library(timeDate)
library(tidyr)
library(geojsonsf)
library(leaflet)
library(geojsonio)
library(plotly)
library(leaflet.extras)
library(tidyr)
library(dygraphs)
library(xts)  
library(TSstudio)
```


```{r message=FALSE}
county <- read_csv("/Users/fairystephanie/Desktop/ETC5523/Blog1/blog-xgoh0002/data/Covid19CountyStatisticsHPSCIrelandOpenData.csv")
timestamp <- read_csv("/Users/fairystephanie/Desktop/ETC5523/Blog1/blog-xgoh0002/data/Covid19CountyStatisticsHPSCIreland.csv")
total <- read_csv("/Users/fairystephanie/Desktop/ETC5523/Blog1/blog-xgoh0002/data/CovidStatisticsProfileHPSCIrelandOpenData.csv")
```

contains Covid-19 Daily Statistics for Ireland by County as reported by the Health Protection Surveillance Centre

```{r}
table1 <- county %>%
  select(CountyName, ConfirmedCovidCases, PopulationProportionCovidCases, PopulationCensus16) %>%
  arrange(-ConfirmedCovidCases)
  
```

```{r table1, echo=FALSE}
DT::datatable(table1, class = 'cell-border stripe', colnames = c('County Name', 'Confirmed Covid Cases', 'Population Proportion Covid Cases', 'Population Census 16'), caption = 'Table 1 -- Total cummulative confirmed covid cases in each county in Ireland', filter = 'top', options = list( pageLength = 10)) 
```


```{r}
a <- geojson_sf("/Users/fairystephanie/Desktop/ETC5523/Blog1/blog-xgoh0002/data/CovidCounty.geojson")
```


```{r}
aa <- a %>% select(CountyName, ConfirmedCovidCases, geometry, ORIGID) %>%
  group_by(CountyName, ORIGID ) %>% 
summarise(ConfirmedCovidCases = sum(ConfirmedCovidCases))
```

```{r}

bins <- c(0, 40000, 80000, 120000, 160000, 200000, Inf)
pal <- colorBin("YlOrRd", domain = aa$ConfirmedCovidCases, bins = bins, na.color = "#aaaaaa")
labels <- sprintf(
  "<strong>%s</strong><br/>%g Confirmed COVID Cases <sup></sup>",
  aa$CountyName, aa$ConfirmedCovidCases
) %>% 
  lapply(htmltools::HTML)


m <- leaflet(aa) %>% addTiles()  %>% setView(-8,53.6,6) %>%
  addPolygons(color = "#444444", weight = 1, smoothFactor = 0.5,
    opacity = 1.0, fillOpacity = 0.5,
    fillColor = ~pal(ConfirmedCovidCases),
    highlightOptions = highlightOptions(color = "white", weight = 2,
      bringToFront = TRUE), label = labels,
              labelOptions = labelOptions(style = list("font-weight" = "normal", 
                                                       padding = "3px 8px"),
                                          textsize = "15px",
                                          direction = "auto")) %>% 
  addLegend(pal=pal,values=~ConfirmedCovidCases,title = "Ireland Confirmed Covid Cases",position='bottomright')

m
```



```{r}
table3 <- timestamp %>%
  select(CountyName, TimeStamp, ConfirmedCovidCases) %>%
  mutate(Date = as.Date(TimeStamp)) 
table3[is.na(table3)] = 0
```

```{r}
finaltable3 <- table3 %>%
  select(Date, CountyName, ConfirmedCovidCases) %>%
  group_by(CountyName) %>%
  filter(CountyName %in% c("Dublin", "Cork", "Donegal", "Limerick", "Galway"))

```


```{r}
ggplot(finaltable3, aes(x = Date,
                        y = ConfirmedCovidCases)) +
 # geom_area(fill="#69b3a2", alpha=0.5) +
    geom_line(color="#69b3a2") +
  facet_wrap(~CountyName, ncol = 1, scales = "free") +
  scale_x_date(date_breaks = "1 month") +
 theme_bw()
```


```{r}
table4 <- total %>%
  select(Date, ConfirmedCovidCases, ConfirmedCovidDeaths) 
  
```

```{r}
xx <- table4 %>% xts(order.by = as.POSIXct(table4$Date))
```


```{r}
graph <- dygraph(xx, main = 'The time series Covid situation  in Ireland') %>%
  dyOptions(labelsUTC = TRUE, fillGraph=TRUE, fillAlpha=0.1, drawGrid = FALSE, colors="#D8AE5A") %>%
  dyLegend(show = "always", hideOnMouseOut = FALSE) %>%
  dyRangeSelector() %>%
  dyCrosshair(direction = "vertical") %>%
  dyHighlight(highlightCircleSize = 5, highlightSeriesBackgroundAlpha = 0.2, hideOnMouseOut = FALSE)  %>%
  dyRoller(rollPeriod = 1) 
graph
```

```{r}
table5 <- total %>%
  select( Male, Female, Unknown)
table5[is.na(table5)] = 0
  
```


```{r}
cc <- table5 %>%
  mutate(Male = Male - lag(Male, default = Male[1]),
         Female = Female - lag(Female, default = Female[1]),
         Unknown = Unknown - lag(Unknown, default = Unknown[1])) %>%
  summarise(Male = sum(Male),
            Female = sum(Female),
            Unknown = sum(Unknown))
```

```{r}
tt <- pivot_longer(cc, cols = Male:Unknown, names_to = c("Gender")) 
```



```{r}

fig <- plot_ly(tt, labels = ~Gender, values = ~value, type = 'pie')
fig <- fig %>% layout(title = 'Gender proportion ',
         xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
         yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))

fig
```


