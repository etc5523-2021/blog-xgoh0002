---
title: "üò∑ Coronavirus in Spain üá™üá∏"
description: |
  A simple analysis on the COVID-19 situation in Spain.
author:
  - name: Xueqi Goh
    url: https://example.com/norajones
date: 09-02-2021
output:
  distill::distill_article:
    self_contained: false
---



```{r, echo = FALSE}
library(dplyr)
library(tidyverse)
library(ggplot2)
library(readr)
library(gt)
library(lubridate)
```

# Data Description üìñ

#### Data Source
The dataset used for this analysis is extracted from the [github repository](https://github.com/owid/covid-19-data/tree/master/public/data) of Our World in Data and the [github repository](https://github.com/RamiKrispin/coronavirus) of Rami Krispin. The first data extracted is about worldwide covid-19 confirmed cases number and the second data extracted is about worldwide vaccination status. However, we will only focus on the data relevant with SPAIN. The original datasets were maintained by [Our World in Data](https://ourworldindata.org/coronavirus) and will be updated daily throughout the period of the pandemic.

#### Date Structure
Below are the data dictionary for the datasets related to this analysis.

**dataset1**

|variable                  |class     |description                      |
|:------------------------:|:--------:|:-------------------------------:|
|date                      |date      |Date recorded                    |
|total-cases               |double    |Total cases recorded             |
|new_cases                 |double    |New cases recorded               | 
|total_deaths              |double    |Total deaths recorded            |
|new_deaths                |double    |New deaths reco                  |
|icu_patients              |double    |Number of patients in ICU        |


**dataset2**

|variable                    |class     |description                      |
|:--------------------------:|:--------:|:-------------------------------:|
|Month                       |character |Month recorded                   |
|doses_admin                 |double    |Total vaccine administered       |
|people_partially_vaccinated |double    |People partially vaccinated      | 
|people_fully_vaccinated     |double    |People fully vaccinated          |



#### Acknowledgment
As mentioned from the original data source, there were negative values in cases and deaths from the first data, it can sometimes appear when a country corrects historical data, because it had previously overestimated the number of cases/deaths.


```{r data, echo=FALSE, message=FALSE}
data <- read_csv("/Users/fairystephanie/Desktop/ETC5523/Blog1/blog-xgoh0002/data/owid-covid-data.csv")
```


```{r vaccine, message = FALSE, echo =FALSE}
vaccine <- read_csv("/Users/fairystephanie/Desktop/ETC5523/Blog1/blog-xgoh0002/data/covid19_vaccine.csv")
```


# Findings üîç


As the pandemic continues to spread around the world, Spain has been one of the most affected countries. Table 1 shows the Covid-19 situation in Spain from Feb 2020 to Sep 2021. This table records the daily new and total Coronavirus cases, daily new and total death Coronavirus cases in Spain and the daily number of patients admitted into ICU due to Coronavirus in Spain. The filter can assist in data exploration. 

```{r spain, echo=FALSE}
dataset1 <- data %>%
  filter(location == "Spain") %>%
  select(date, total_cases, new_cases, total_deaths, new_deaths, icu_patients) 
  dataset1[is.na(dataset1)] = 0
  
```


```{r table1, echo=FALSE}
DT::datatable(dataset1, class = 'cell-border stripe', colnames = c('Date', 'Total Cases', 'New Cases', 'Total Deaths', 'New Deaths', 'ICU patients'), caption = 'Covid-19 Situation in Spain from Feb 2020 to Sep 2021', filter = 'top', options = list( pageLength = 10)) 
```


# Vaccination Status üíâ

While healthcare providers are fighting Coronavirus to safeguard the lives of everyone affected, researchers are racing to develop such a vaccine to save lives. 


```{r extract date, echo=FALSE}
vaccine <- vaccine
myDate = as.POSIXct(vaccine$date)  
month <- format(myDate,"%m")
mymonths <- c("Jan","Feb","Mar",
              "Apr","May","Jun",
              "Jul","Aug","Sep",
              "Oct","Nov","Dec")
vaccine <- vaccine %>%
  add_column(newColname = myDate) %>%
  mutate(Month = month(newColname)) 
vaccine$Month <- mymonths[ vaccine$Month]
```


```{r dataset2, echo=FALSE}
dataset2 <- vaccine %>%
  filter(country_region == "Spain") %>%
  select(Month, doses_admin, people_partially_vaccinated, people_fully_vaccinated) %>%
  dplyr::group_by(Month) %>%
  summarise(doses_admin = sum(doses_admin),
            people_partially_vaccinated = sum(people_partially_vaccinated),
            people_fully_vaccinated= sum(people_fully_vaccinated)) %>%
  arrange(-doses_admin)

```


```{r table2, echo=FALSE}
gt(dataset2) %>%
  tab_header(title = "COVID-19 Vaccination Status in Spain from Jan 2021 to Aug 2021",
             subtitle = "Arranged by Sum of Total Vaccine Administered (High to Low)") %>%
  cols_label(
    Month = html("Month"),
    doses_admin = html('Total Vaccine Administered'),
    people_partially_vaccinated = html('People Partially Vaccinated'),
    people_fully_vaccinated = html('People Fully Vaccinated')
  )
```

```{r plot1, echo=FALSE}
gg <- ggplot(dataset2, aes(x = reorder(Month, -doses_admin),
                     y = doses_admin)) +
  geom_bar(stat = "identity", fill="#00abff") +
  theme_bw() +
  xlab("Month") +
  ylab("Number of vaccine administered") +
  ggtitle("The number of vaccine administered in Spain in 2021")
plotly::ggplotly(gg)
```



Distill is a publication format for scientific and technical writing, native to the web.

Learn more about using Distill at <https://rstudio.github.io/distill>.

#Reference

Hasell, J., Mathieu, E., Beltekian, D. et al. A cross-country database of COVID-19 testing. Sci Data 7, 345 (2020)

Dom√≠nguez‚ÄêGil, B., Coll, E., Fern√°ndez‚ÄêRuiz, M., Corral, E., Del R√≠o, F., Zaragoza, R., ... & Hern√°ndez, D. (2020). COVID‚Äê19 in Spain: Transplantation in the midst of the pandemic. American journal of transplantation, 20(9), 2593-2598.

